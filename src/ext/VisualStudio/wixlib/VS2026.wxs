<!-- Copyright (c) .NET Foundation and contributors. All rights reserved. Licensed under the Microsoft Reciprocal License. See LICENSE.TXT file in the project root for full license information. -->


<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
    <?include ..\..\caDecor.wxi ?>

    <Fragment>
        <Property Id="VS2026_ROOT_FOLDER" Secure="yes" />
    </Fragment>

    <Fragment>
        <PropertyRef Id="VS2026_ROOT_FOLDER" />
        <Property Id="VS2026_IDE_DIR" Secure="yes">
            <DirectorySearch Id="VS2026DirectorySearch" Path="[VS2026_ROOT_FOLDER]">
                <DirectorySearch Id="VS2026EnvironmentDirectorySearch" Path="Common7\IDE" Depth="1" />
            </DirectorySearch>
        </Property>
    </Fragment>

    <Fragment>
        <Property Id="VS2026_EXTENSIONS_DIR" Secure="yes">
            <DirectorySearchRef Id="VS2026EnvironmentDirectorySearch" Parent="VS2026DirectorySearch" Path="Common7\IDE">
                <DirectorySearch Id="VS2026ExtensionsDirectorySearch" Path="Extensions" Depth="1" />
            </DirectorySearchRef>
        </Property>
    </Fragment>

    <Fragment>
        <Property Id="VS2026_PROJECTTEMPLATES_DIR" Secure="yes">
            <DirectorySearchRef Id="VS2026EnvironmentDirectorySearch" Parent="VS2026DirectorySearch" Path="Common7\IDE">
                <DirectorySearch Id="VS2026ProjectTemplatesDirectorySearch" Path="ProjectTemplates" Depth="1" />
            </DirectorySearchRef>
        </Property>
    </Fragment>

    <Fragment>
        <PropertyRef Id="VS2026_ROOT_FOLDER" />
        <Property Id="VS2026_SCHEMAS_DIR" Secure="yes">
            <DirectorySearch Id="VS2026XmlDirectorySearch" Path="[VS2026_ROOT_FOLDER]\Xml" Depth="1">
                <DirectorySearch Id="VS2026XmlSchemasDirectorySearch" Path="Schemas" Depth="1" />
            </DirectorySearch>
        </Property>
    </Fragment>

    <Fragment>
        <Property Id="VS2026_ITEMTEMPLATES_DIR" Secure="yes">
            <DirectorySearchRef Id="VS2026EnvironmentDirectorySearch" Parent="VS2026DirectorySearch" Path="Common7\IDE">
                <DirectorySearch Id="VS2026ItemTemplatesDirectorySearch" Path="ItemTemplates" Depth="1" />
            </DirectorySearchRef>
        </Property>
    </Fragment>

    <Fragment>
        <PropertyRef Id="VS2026_ROOT_FOLDER" />
        <Property Id="VS2026_BOOTSTRAPPER_PACKAGE_FOLDER" Secure="yes">
            <DirectorySearch Id="VS2026SDKDirectorySearch" Path="[VS2026_ROOT_FOLDER]\SDK" Depth="1">
                <DirectorySearch Id="SearchForVS2026BootstrapperPackageDirectory" Path="Bootstrapper" Depth="1" />
            </DirectorySearch>
        </Property>
    </Fragment>

    <Fragment>
        <Property Id="VS2026DEVENV" Secure="yes">
            <DirectorySearchRef Id="VS2026EnvironmentDirectorySearch" Parent="VS2026DirectorySearch" Path="Common7\IDE">
                <FileSearch Id="VS2026DevEnvSearch" Name="devenv.exe" />
            </DirectorySearchRef>
        </Property>
    </Fragment>

    <Fragment>
        <CustomAction Id="VS2026Setup" Property="VS2026DEVENV" ExeCommand="/setup" Execute="deferred" Return="ignore" Impersonate="no" />
        <PropertyRef Id="VS2026DEVENV" />

        <InstallExecuteSequence>
            <Custom Action="VS2026Setup" Before="InstallFinalize" Overridable="yes" Condition="VS2026DEVENV" />
        </InstallExecuteSequence>
    </Fragment>

    <Fragment>
        <CustomAction Id="VS2026InstallVSTemplates" Property="VS2026DEVENV" ExeCommand="/InstallVSTemplates" Execute="deferred" Return="ignore" Impersonate="no" />
        <PropertyRef Id="VS2026DEVENV" />

        <InstallExecuteSequence>
            <Custom Action="VS2026InstallVSTemplates" Before="InstallFinalize" Overridable="yes" Condition="VS2026DEVENV" />
        </InstallExecuteSequence>
    </Fragment>

    <!-- Indicates whether the Visual C# project system is installed as a part of  -->
    <!-- Visual Studio 2019 standard or higher. If this property is set, that      -->
    <!-- means Visual Studio 2019 standard or higher is installed and the Visual   -->
    <!-- C# language tools were installed as a part of VS 2019 setup.              -->
    <Fragment>
        <Property Id="VS2026_IDE_VCSHARP_PROJECTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>

    <!-- Indicates whether the Visual Basic project system is installed as a part of -->
    <!-- Visual Studio 2019 standard or higher. If this property is set, that        -->
    <!-- means Visual Studio 2019 standard or higher is installed and the Visual     -->
    <!-- Basic language tools were installed as a part of VS 2019 setup.             -->
    <Fragment>
        <Property Id="VS2026_IDE_VB_PROJECTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>

    <!-- Indicates whether the Visual Web Developer project system is installed as a part of -->
    <!-- Visual Studio 2019 standard or higher. If this property is set, that                -->
    <!-- means Visual Studio 2019 standard or higher is installed and the Visual             -->
    <!-- Web Developer language tools were installed as a part of VS 2019 setup.             -->
    <Fragment>
        <Property Id="VS2026_IDE_VWD_PROJECTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>

    <!-- Indicates whether the Visual C++ project system is installed as a part of -->
    <!-- Visual Studio 2019 standard or higher. If this property is set, that      -->
    <!-- means Visual Studio 2019 standard or higher is installed and the Visual   -->
    <!-- C++ language tools were installed as a part of VS 2019 setup.             -->
    <Fragment>
        <Property Id="VS2026_IDE_VC_PROJECTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>

    <!-- Indicates whether the Visual Studio 2019 Team Test project system is installed -->
    <Fragment>
        <Property Id="VS2026_IDE_VSTS_TESTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>

    <!-- Indicates whether the Visual Studio Modeling project system is installed -->
    <Fragment>
        <Property Id="VS2026_IDE_MODELING_PROJECTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>

    <!-- Indicates whether the Visual Studio F# project system is installed -->
    <Fragment>
        <Property Id="VS2026_IDE_FSHARP_PROJECTSYSTEM_INSTALLED" Secure="yes" />
    </Fragment>
</Wix>
